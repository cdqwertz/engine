<html>
	<head>
		<title>Game</title>
		<style>
			#canvas {
				position:absolute;
				top:0px;
				left:0px;
			}

			#screen {
				display: none;
			}
		</style>
	</head>
	<body onload="onInit()">
		<canvas id="screen"></canvas>
		<canvas id="canvas"></canvas>

		<script src="vector.js"></script>
		<script src="input.js"></script>
		<script src="messages.js"></script>
		<script src="actor.js"></script>
		<script src="scene.js"></script>
		<script src="components.js"></script>
		<script src="gui.js"></script>
		<script src="path.js"></script>
		<script src="physics.js"></script>
		<script src="core.js"></script>

		<script>
			//Test component
			function move(type, speed, jumpForce) {
				this.componentType = "move";
				this.t = null;
				this.type = type || 0;
				this.speed = speed || 0;
				this.jumpForce = jumpForce || speed;

				this.start =  function(obj) {
					this.t = obj.getComponent("transform");
					this.motion = obj.getComponent("motion");
				};

				this.update = function(obj) {
					if(this.type == 0) {
						var x = 0;
						var y = 0;
						if (input.getKey(keyCodes.arrow_up) == true) {
							y += -this.speed;
						}
						if (input.getKey(keyCodes.arrow_left) == true) {
							x += -this.speed;
						}
						if (input.getKey(keyCodes.arrow_right) == true) {
							x += this.speed;
						}
						if (input.getKey(keyCodes.arrow_down) == true) {
							y += this.speed;
						}
						this.motion.velocity.x += x;
						this.motion.velocity.y += y;
					} else if(this.type == 1) {
						var x = 0;
						var y = 0;
						if (input.getKey(keyCodes.w) == true) {
							y += -this.speed;
						}
						if (input.getKey(keyCodes.a) == true) {
							x += -this.speed;
						}
						if (input.getKey(keyCodes.d) == true) {
							x += this.speed;
						}
						if (input.getKey(keyCodes.s) == true) {
							y += this.speed;
						}
						this.motion.velocity.x += x;
						this.motion.velocity.y += y;
					}
				};
			}

			//Load

			function load()
			{
				var ball = new actor();
				ball.addComponent(new transform(new vec2(200, 100), 0));
				//ball.addComponent(new bounce());
				ball.addComponent(new move(0, 0.05));
				ball.addComponent(new motion(new vec2(0.7, 0), 0, null, 0.03, 0.03));
				var ballColl = new boxCollider(0, 0, 50, 50, "wall", true)
				ball.addComponent(ballColl);
				ball.addComponent(new simpleRigidbody());
				ball.addComponent(new drawRect(new vec2(0, 0), new vec2(50, 50), "#FF0000"));
				ball.addComponent(new loop());

				mainScene.addObject(ball);

				var wall1 = new actor();
				wall1.addComponent(new transform(new vec2(25, screen.h/2), 0));
				var wall1Coll = new boxCollider(0,0, 50, screen.h, "wall", false)
				wall1.addComponent(wall1Coll);
				wall1.addComponent(new drawRect(new vec2(0, 0), new vec2(50, screen.h)));

				//mainScene.addObject(wall1);

				var wall2 = new actor();
				wall2.addComponent(new transform(new vec2(screen.w-25, screen.h/2), 0));
				var wall2Coll = new boxCollider(0,0, 50, screen.h, "wall", false)
				wall2.addComponent(wall2Coll);
				wall2.addComponent(new drawRect(new vec2(0, 0), new vec2(50, screen.h)));

				//mainScene.addObject(wall2);

				var wall3 = new actor();
				wall3.addComponent(new transform(new vec2(screen.w/2, 25), 0));
				var wall3Coll = new boxCollider(0,0, screen.w, 50, "wall", false)
				wall3.addComponent(wall3Coll);
				wall3.addComponent(new drawRect(new vec2(0, 0), new vec2(screen.w, 50)));

				//mainScene.addObject(wall3);

				var wall4 = new actor();
				wall4.addComponent(new transform(new vec2(screen.w/2, screen.h-25), 0));
				var wall4Coll = new boxCollider(0,0, screen.w, 50, "wall", false)
				wall4.addComponent(wall4Coll);
				wall4.addComponent(new drawRect(new vec2(0, 0), new vec2(screen.w, 50)));

				mainScene.addObject(wall4);

				var wall5 = new actor();
				wall5.addComponent(new transform(new vec2(screen.w/2, screen.h/2), 0));
				var wall5Coll = new boxCollider(0,0, 100, 100, "wall", true)
				wall5.addComponent(wall5Coll);
				wall5.addComponent(new motion(new vec2(0, 0), 0, null, 0.03, 0.03));
				//wall5.addComponent(new bounce());
				wall5.addComponent(new loop());
				wall5.addComponent(new simpleRigidbody());
				wall5.addComponent(new drawRect(new vec2(0, 0), new vec2(100, 100)));
				wall5.addComponent(new move(1, 0.05));

				mainScene.addObject(wall5);

				
				var collLayer = new collisionLayer();
				collLayer.addCollider(ballColl);
				//collLayer.addCollider(wall1Coll);
				//collLayer.addCollider(wall2Coll);
				//collLayer.addCollider(wall3Coll);
				collLayer.addCollider(wall4Coll);
				collLayer.addCollider(wall5Coll);
				mainScene.physicsManager.addLayer(collLayer);

				//mainScene.addObject(test);
			}
		</script>
	</body>
</html>
