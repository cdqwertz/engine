<html>
	<head>
		<title>Game</title>
	</head>
	<body onload="onInit()">
		<canvas id="screen"></canvas>

		<script src="vector.js"></script>
		<script src="input.js"></script>
		<script src="actor.js"></script>
		<script src="scene.js"></script>
		<script src="components.js"></script>
		<script src="physics.js"></script>
		<script src="core.js"></script>

		<script>
			function move() {
				this.componentType = "move";
				this.update = function(obj) {
					if (input.getKey(38) == true) {
						obj.components[2].getPos().add(new vec2(0, -0.2*time.dtime));
					}
					if (input.getKey(37) == true) {
						obj.components[2].getPos().add(new vec2(-0.2*time.dtime, 0));
					}
					if (input.getKey(39) == true) {
						obj.components[2].getPos().add(new vec2(0.2*time.dtime, 0));
					}
					if (input.getKey(40) == true) {
						obj.components[2].getPos().add(new vec2(0, 0.2*time.dtime));
					}
				};

				this.afterDraw = function(obj) {
					ctx.fillStyle = "#000000";
				};

				this.draw = function(obj) {
					var coll = obj.components[obj.findComponent("boxCollider")];

					if(coll.other) {
						ctx.fillStyle = "#FF0000";
					} else {
						ctx.fillStyle = "#000000";
					}
				};
			}

			function load()
			{
				var ball = new actor();
				ball.addComponent(new transform(new vec2(50, 50), new vec2(0, 0)));
				ball.addComponent(new bounce());
				ball.addComponent(new velocity(new vec2(0.3, 0.1)));
				var ballColl = new boxCollider(0, 0, 50, 50, "ball", true)
				ball.addComponent(ballColl);
				ball.addComponent(new drawRect(new vec2(0, 0), new vec2(50, 50)));

				mainScene.addObject(ball);

				var wall1 = new actor();
				wall1.addComponent(new transform(new vec2(0, 0), new vec2(0, 0)));
				var wall1Coll = new boxCollider(0, 0, 50, screen.h, "wall", false)
				wall1.addComponent(wall1Coll);
				wall1.addComponent(new drawRect(new vec2(0, 0), new vec2(50, screen.h)));

				mainScene.addObject(wall1);

				var wall2 = new actor();
				wall2.addComponent(new transform(new vec2(screen.w-50, 0), new vec2(0, 0)));
				var wall2Coll = new boxCollider(0, 0, 50, screen.h, "wall", false)
				wall2.addComponent(wall2Coll);
				wall2.addComponent(new drawRect(new vec2(0, 0), new vec2(50, screen.h)));

				mainScene.addObject(wall2);

				
				var collLayer = new collisionLayer();
				collLayer.addCollider(ballColl);
				collLayer.addCollider(wall1Coll);
				collLayer.addCollider(wall2Coll);
				physicsLayers.addLayer(collLayer);

				//mainScene.addObject(test);
			}
		</script>
	</body>
</html>
